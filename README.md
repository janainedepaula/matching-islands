# Visualization-Islands-from-Gipsy2
Visualization and Similarity Analysis of Virulence Islands (GIPSy2 Output)

This repository contains Python scripts designed to compare virulence islands (or any other genomic island type) across two or more bacterial strains.

The scripts generate similarity metrics based on protein-level alignments and can optionally be integrated with Cytoscape for network visualization.

These tools were developed to assist comparative genomics workflows involving GIPSy2 outputs.

# 1. match_islands.py PURPOSE

match_islands.py performs pairwise comparisons of all Virulence_Island_.faa files generated by GIPSy2.

Although originally applied to virulence islands, any genomic island type can be analyzed simply by changing the input filenames inside the script.

The script expects .faa files located inside: xxxx_Islands_fisher/Amino_acids/ . e.g., IHP2050_Islands_fisher/Amino_acids/Virulence_Island_1.faa

All .faa files found are stored in a dictionary (faa_files) for further processing.

How match_islands.py works: 
1. Sequence Alignment:
   
   The script reads all protein sequences from every .faa file; 2. Aligns each protein from one file against all proteins from every other file and 3. Includes comparisons within the same strain (e.g., Island 1 vs. Island 2) and comparisons between different strains (e.g., IHP2050 vs. IHP2060). Alignment is performed using Bio.Align.PairwiseAligner (match_score = 1, mismatch_score = 0). This means sequence identity is computed as: identity = number of matches / lenght of the longest sequence. 

This prevents relying solely on FASTA headers (which may contain annotation discrepancies) and ensures true sequence-based comparison.

2. Identifying Matches:

For each gene the script finds the best match in the target island and applay identity thresholds (default): ≥ 90% → high-identity match; < 90% → low-identity match. 

Thresholds can be edited inside the script and its also detects differences in the number of genes between islands, identifies islands with no significant matches and produces detailed percentage-based summaries.

3. Output Files:

virulence_island_comparison_results.txt: Contains an overall summary, high-identity matches (≥ 90%) between proteins and percentage similarity between islands.
low_identity_matches.txt: Contains all matches with < 90% identity. 

----------------------------- parei aqui 

###COMPARAÇÃO PAR A PAR DE ARQUIVOS ###
Para cada par único de arquivos .faa, o script lê as sequências (genes) dos dois arquivos e para cada gene do arquivo A, encontra o gene mais similar no arquivo B.
Calcula a identidade relativa da melhor correspondência. Se a identidade for: 
- ≥ 0.9 (90%), a correspondência é armazenada como alta identidade no 'virulence_island_comparison_results'.
- < 0.9, ela entra como baixa identidade e é armazenada em 'low_identity_matches'.

### E ILHAS SEM CORRESPONDÊNCIA (ILHAS EXCLUSIVAS)? ###
O script identifica quais arquivos .faa não tiveram nenhuma correspondência com identidade ≥ 90% com qualquer outro. 
Isso é relatado no resumo como ilhas sem correspondência.

#### biblios em python usadas ###
- Bio.SeqIO: para ler os arquivos .faa e FASTA.
- Bio.Align.PairwiseAligner: para realizar o alinhamento par a par (global) entre proteínas.
	- A pontuação é definida como: match_score = 1; mismatch_score = 0, logo a "identidade" será uma fração simples: nº de matches / comprimento da maior sequência.
- os, pathlib, collections: para manipular diretórios, caminhos e estruturas auxiliares.

** O script precisa estar em uma pasta que possui ele + as duas (ou mais) pastas de output do gipsy2 tipo 'xxxx_Islands_fisher'. 
** Demora um pouco por conta do alinhamento, recomendo usar screen.

## COMO RODAR
'python3 match_islands.py' dentro do diretório que tem as pastas de interesse.

#### parte 02
script: network_similarity.py

Ele vai procurar dentro do arquivo virulence_island_comparison_results.txt gerado pelo match islands os valores de similaridades apresentados na comparação par a par. 
Depois, ele vai classificar esses valores da seguinte forma:
ilhas que possuem > 90% de similaridade;
ilhas que possuem similaridade > 50% x <90%
ilhas que possuem similaridade < 50%. 

Vai gerar um arquivo chamado: cytoscape_virulence_network_filtered.csv. 
Dentro de cytoscape_virulence_network_filtered.csv terá 4 colunas, sendo a última mostrando à qual classe aquela comparação pertence. 
Só abrir no cytoscape depois. 
  - aqui, talvez, seja bom filtrar o arquivo para mostrar somente as de interesse, pois o cytoscape_virulence_network_filtered.csv pode ser grande e atrapalhar a visualização. 

