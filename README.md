# Visualization-Islands-from-Gipsy2
Visualization and Similarity Analysis of Virulence Islands (GIPSy2 Output)

This repository contains Python scripts designed to compare virulence islands (or any other genomic island type) across two or more bacterial strains.

The scripts generate similarity metrics based on protein-level alignments and can optionally be integrated with Cytoscape for network visualization.

These tools were developed to assist comparative genomics workflows involving GIPSy2 outputs.

# 1. match_islands.py PURPOSE

match_islands.py performs pairwise comparisons of all Virulence_Island_.faa files generated by GIPSy2.

Although originally applied to virulence islands, any genomic island type can be analyzed simply by changing the input filenames inside the script.

The script expects .faa files located inside: xxxx_Islands_fisher/Amino_acids/ . e.g., IHP2050_Islands_fisher/Amino_acids/Virulence_Island_1.faa

All .faa files found are stored in a dictionary (faa_files) for further processing.

How match_islands.py works: 
1. Sequence Alignment:
   
   The script reads all protein sequences from every .faa file; 2. Aligns each protein from one file against all proteins from every other file and 3. Includes comparisons within the same strain (e.g., Island 1 vs. Island 2) and comparisons between different strains (e.g., IHP2050 vs. IHP2060). Alignment is performed using Bio.Align.PairwiseAligner (match_score = 1, mismatch_score = 0). This means sequence identity is computed as: identity = number of matches / lenght of the longest sequence. 

This prevents relying solely on FASTA headers (which may contain annotation discrepancies) and ensures true sequence-based comparison.

2. Identifying Matches:

For each gene the script finds the best match in the target island and applay identity thresholds (default): ≥ 90% → high-identity match; < 90% → low-identity match. For each unique pair of .faa files, read sequences from File A and File B. For each gene in File A, identify its most similar homolog in File B. 

Thresholds can be edited inside the script and its also detects differences in the number of genes between islands, identifies islands with no significant matches and produces detailed percentage-based summaries.

3. Output Files:

virulence_island_comparison_results.txt: Contains an overall summary, high-identity matches (≥ 90%) between proteins and percentage similarity between islands.
low_identity_matches.txt: Contains all matches with < 90% identity. 

The script automatically detects islands that do not share any match ≥ 90%, are therefore considered exclusive islands. These are reported in the global summary

Python libraries:

-> Bio.SeqIO: Reading FASTA and .faa files. 

-> Bio.Align.PairwiseAligner: Pairwise global alignment.

-> os, pathlib: Directory and file handling.

-> collections: Auxiliary data structures.

# match_islands.py RUNNING

The script must be placed inside a folder containing at least two folders of interest, because it searches both within and between these directories.

Alignment is computationally expensive so I recommend run using screen or tmux on Linux.

# 2. network_similarity.py PURPOSE

This script processes the output of match_islands.py "virulence_island_comparison_results.txt". 

network_similarity extracts similarity values computed in the pairwise comparison and classifies island similarity into three categories based on similarity range: >90% (Highly similar islands), 50–90%
(Moderately similar islands) and <50% (Low similarity/divergent). Generates an archieve called "cytoscape_virulence_network_filtered.csv". 

These classifications can be exported to build network graphs in Cytoscape (Recommended). 
 
